/**
* @description 
* @author Dayana Daniel
*/
@isTest
public class NMTMigratorBatchTest {
    /**
* @description tests notes migration by Ids
* Test Case Name: Migrate by note id
* Test Case Name: Set a existing record id at migrate by note id
*/
    @isTest
    static void testNotestMigrationById(){
        if(NAMUtils.isEnhancedNotesEnabled()||NAMUtils.ENABLE_NOTES_TESTS){
        /*
* Steps:
* - create a contact 
* - create two legacy note
* - get the ids
* - run the migration by Ids
* - assert 2 contentVersions were created
* - assert 2 CDLs were created
* - rerun the migration by Ids
* - assert 2 contentVersions were created
* - assert 2 CDLs were created
*/
        
        Contact c = NMTTestNoteUtils.createContact();
        //create two legacy note
        List<Note> notes = NMTTestNoteUtils.createNoteForObject(2, c.Id, false);
        List<String> resultAux = new List<String>();
        //get the ids
        for(Note note:notes)
        {
            resultAux.add(note.Id);
        }
        
        //assert that 2 Legacy Notes were created
        System.assertEquals(2, resultAux.size(), '2 Legacy Notes created to migrate');
        
        Test.startTest();
        //run the migration by Ids  
        NMTMigratorBatch batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today(), true);
        Id batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
        
        NMTTestNoteUtils.sleep(10);
        
        //rerun the migration by Ids    
        batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today(), true);
        batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
        Test.stopTest();
        
        List<NAMNoteConverted__c> contentVersions = [SELECT Id FROM NAMNoteConverted__C WHERE LegacyNoteConvertedId__c in :resultAux];
        //assert 2 contentVersions were created
        System.assertEquals(2, contentVersions.size(), '2 Content Notes created');
        
        List<ContentDocumentLink> cdls = [SELECT Id FROM ContentDocumentLink WHERE
                                          linkedEntityId = :c.Id
                                          AND
                                          contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c in :resultAux];
        //assert 2 CDLs were created
        System.assertEquals(2, cdls.size(), '2 Content Notes linked to the parent Contact');
        NAMUtils.lastContentDocument(0,10);
        }
    }
    
    /**
* @description tests content version deletion
*/
    @isTest
    static void testContentVersionDeletion(){
        if(NAMUtils.isEnhancedNotesEnabled()||NAMUtils.ENABLE_NOTES_TESTS){
        /*
* Steps:
* - create a contact 
* - create two legacy note
* - get the ids
* - run the migration by Ids
* - assert 2 ConvertedNote were created
* - assert 2 CDLs were create
* - delete the ContentDocuments
* - assert the ConvertedNote were deleted
*/
        
        Contact c = NMTTestNoteUtils.createContact();
        //create two legacy note
        List<Note> notes = NMTTestNoteUtils.createNoteForObject(2, c.Id, false);
        List<String> resultAux = new List<String>();
        //get the ids
        for(Note note:notes)
        {
            resultAux.add(note.Id);
        }
        
        //assert that 2 Legacy Notes were created
        System.assertEquals(2, resultAux.size(), '2 Legacy Notes created to migrate');
        
        Test.startTest();
        //run the migration by Ids  
        NMTMigratorBatch batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today(), true);
        Id batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
        
        NMTTestNoteUtils.sleep(10);
        
        //rerun the migration by Ids    
        batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today(), true);
        batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
        Test.stopTest();
        
        List<NAMNoteConverted__c> contentVersions = [SELECT Id FROM NAMNoteConverted__C WHERE LegacyNoteConvertedId__c in :resultAux];
        //assert 2 contentVersions were created
        System.assertEquals(2, contentVersions.size(), '2 Content Notes created');
        
        List<ContentDocumentLink> cdls = [SELECT Id FROM ContentDocumentLink WHERE
                                          linkedEntityId = :c.Id
                                          AND
                                          contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c in :resultAux];
        //assert 2 CDLs were created
        System.assertEquals(2, cdls.size(), '2 Content Notes linked to the parent Contact');
        
        //delete the ContentDocuments
        List<ContentDocument> cds = [SELECT Id FROM ContentDocument WHERE
                                          latestPublishedVersion.LegacyNoteConvertedId__c in :resultAux];
        delete cds;
            
        //assert the ConvertedNote were deleted
         List<NAMNoteConverted__c> contentVersions2 = [SELECT Id FROM NAMNoteConverted__C WHERE LegacyNoteConvertedId__c in :resultAux];
        System.assertEquals(0, contentVersions2.size(), 'NOtes Converted were deleted');  
        
        }
    }
    
    /**
* @description tests notes migration by unknown Ids 
*/
    @isTest
    static void testNotestMigrationByUnknownId(){
        if(NAMUtils.isEnhancedNotesEnabled()||NAMUtils.ENABLE_NOTES_TESTS){
        /*
* Steps:
* - run the migration by unknown ids
* - assert 0 contentVersion were created
*/
        
        List<String> auxIds = new List<String>{'000000000000000', '111111111111111'};
            
            Test.startTest();
        //run the migration by Id   
        NMTMigratorBatch batch = new NMTMigratorBatch(null, auxIds, 'byId', null, System.today(), System.today(), true);
        Id batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
        Test.stopTest();
        
        List<NAMNoteConverted__c> contentVersions = [SELECT Id FROM NAMNoteConverted__c];
        //assert 0 contentVersions were created
        System.assertEquals(0, contentVersions.size(), '0 Content Notes created');
        }
    }
    
    /**
* @description tests notes migration with invalid characters
* Test Case Name: Migrate note that has special characters
*/
    @isTest
    static void testNotestMigrationInvalidCharacters(){
        if(NAMUtils.isEnhancedNotesEnabled()||NAMUtils.ENABLE_NOTES_TESTS){
        /*
* Steps:
* - create a contact 
* - create a legacy note with invalid characters in the body
* - get the id
* - run the migration by Id
* - assert 1 contentVersion is created
* - assert 1 CDL is created
*/
        
        Contact c = NMTTestNoteUtils.createContact();
        //create a legacy note
        Note legacynote = new Note();
        legacynote.Title='noteTitle';
        String body = 'Common: & â€œ â€ â€˜ â€™ â€“ â€” â€¦ â€ â€’ Â° Â© Â® â„¢ â€¢ Â½ Â¼ Â¾ â…“ â…” â€  â€¡ Âµ Â¢ Â£ â‚¬ Â« Â» â™  â™£ â™¥ â™¦ Â¿ ï¿½'
            +'Math: - Ã— Ã· Â± âˆ Ï€ âˆ… â‰¤ â‰¥ â‰  â‰ˆ âˆ§ âˆ¨ âˆ© âˆª âˆˆ âˆ€ âˆƒ âˆ„ âˆ‘ âˆ â† â†‘ â†’ â†“ â†” â†• â†– â†— â†˜ â†™ â†º â†» â‡’ â‡”'
            +'SuperSub: â° Â¹ Â² Â³ â´ âµ â¶ â· â¸ â¹ âº â» â½ â¾ â¿ â± â‚€ â‚ â‚‚ â‚ƒ â‚„ â‚… â‚† â‚‡ â‚ˆ â‚‰ â‚Š â‚‹ â‚Œ â‚ â‚'
            +'u00A0:   Â¡ Â¢ Â£ Â¤ Â¥ Â¦ Â§ Â¨ Â© Âª Â« Â¬ Â­ Â® Â¯ Â° Â± Â² Â³ Â´ Âµ Â¶ Â· Â¸ Â¹ Âº Â» Â¼ Â½ Â¾ Â¿'
            +'u00C0: Ã€ Ã Ã‚ Ãƒ Ã„ Ã… Ã† Ã‡ Ãˆ Ã‰ ÃŠ Ã‹ ÃŒ Ã Ã Ã Ã Ã‘ Ã’ Ã“ Ã” Ã• Ã– Ã— Ã˜ Ã™ Ãš Ã› Ãœ Ã Ã ÃŸ'
            +'u00E0: Ã  Ã¡ Ã¢ Ã£ Ã¤ Ã¥ Ã¦ Ã§ Ã¨ Ã© Ãª Ã« Ã¬ Ã­ Ã® Ã¯ Ã° Ã± Ã² Ã³ Ã´ Ãµ Ã¶ Ã· Ã¸ Ã¹ Ãº Ã» Ã¼ Ã½ Ã¾ Ã¿'
            +'u0100: Ä€ Ä Ä‚ Äƒ Ä„ Ä… Ä† Ä‡ Äˆ Ä‰ ÄŠ Ä‹ ÄŒ Ä Ä Ä Ä Ä‘ Ä’ Ä“ Ä” Ä• Ä– Ä— Ä˜ Ä™ Äš Ä› Äœ Ä Ä ÄŸ'
            +'u0120: Ä  Ä¡ Ä¢ Ä£ Ä¤ Ä¥ Ä¦ Ä§ Ä¨ Ä© Äª Ä« Ä¬ Ä­ Ä® Ä¯ Ä° Ä± Ä² Ä³ Ä´ Äµ Ä¶ Ä· Ä¸ Ä¹ Äº Ä» Ä¼ Ä½ Ä¾ Ä¿'
            +'u0140: Å€ Å Å‚ Åƒ Å„ Å… Å† Å‡ Åˆ Å‰ ÅŠ Å‹ ÅŒ Å Å Å Å Å‘ Å’ Å“ Å” Å• Å– Å— Å˜ Å™ Åš Å› Åœ Å Å ÅŸ'
            +'u0160: Å  Å¡ Å¢ Å£ Å¤ Å¥ Å¦ Å§ Å¨ Å© Åª Å« Å¬ Å­ Å® Å¯ Å° Å± Å² Å³ Å´ Åµ Å¶ Å· Å¸ Å¹ Åº Å» Å¼ Å½ Å¾ Å¿'
            +'u0180: Æ€ Æ Æ‚ Æƒ Æ„ Æ… Æ† Æ‡ Æˆ Æ‰ ÆŠ Æ‹ ÆŒ Æ Æ Æ Æ Æ‘ Æ’ Æ“ Æ” Æ• Æ– Æ— Æ˜ Æ™ Æš Æ› Æœ Æ Æ ÆŸ'
            +'u01A0: Æ  Æ¡ Æ¢ Æ£ Æ¤ Æ¥ Æ¦ Æ§ Æ¨ Æ© Æª Æ« Æ¬ Æ­ Æ® Æ¯ Æ° Æ± Æ² Æ³ Æ´ Æµ Æ¶ Æ· Æ¸ Æ¹ Æº Æ» Æ¼ Æ½ Æ¾ Æ¿'
            +'u01C0: Ç€ Ç Ç‚ Çƒ Ç„ Ç… Ç† Ç‡ Çˆ Ç‰ ÇŠ Ç‹ ÇŒ Ç Ç Ç Ç Ç‘ Ç’ Ç“ Ç” Ç• Ç– Ç— Ç˜ Ç™ Çš Ç› Çœ Ç Ç ÇŸ'
            +'u01E0: Ç  Ç¡ Ç¢ Ç£ Ç¤ Ç¥ Ç¦ Ç§ Ç¨ Ç© Çª Ç« Ç¬ Ç­ Ç® Ç¯ Ç° Ç± Ç² Ç³ Ç´ Çµ Ç¶ Ç· Ç¸ Ç¹ Çº Ç» Ç¼ Ç½ Ç¾ Ç¿'
            +'u0200: È€ È È‚ Èƒ È„ È… È† È‡ Èˆ È‰ ÈŠ È‹ ÈŒ È È È È È‘ È’ È“ È” È• È– È— È˜ È™ Èš È› Èœ È È ÈŸ'
            +'u0220: È  È¡ È¢ È£ È¤ È¥ È¦ È§ È¨ È© Èª È« È¬ È­ È® È¯ È° È± È² È³ È´ Èµ È¶ È· È¸ È¹ Èº È» È¼ È½ È¾ È¿'
            +'u0240: É€ É É‚ Éƒ É„ É… É† É‡ Éˆ É‰ ÉŠ É‹ ÉŒ É É É É É‘ É’ É“ É” É• É– É— É˜ É™ Éš É› Éœ É É ÉŸ'
            +'u0260: É  É¡ É¢ É£ É¤ É¥ É¦ É§ É¨ É© Éª É« É¬ É­ É® É¯ É° É± É² É³ É´ Éµ É¶ É· É¸ É¹ Éº É» É¼ É½ É¾ É¿'
            +'u0280: Ê€ Ê Ê‚ Êƒ Ê„ Ê… Ê† Ê‡ Êˆ Ê‰ ÊŠ Ê‹ ÊŒ Ê Ê Ê Ê Ê‘ Ê’ Ê“ Ê” Ê• Ê– Ê— Ê˜ Ê™ Êš Ê› Êœ Ê Ê ÊŸ'
            +'u02A0: Ê  Ê¡ Ê¢ Ê£ Ê¤ Ê¥ Ê¦ Ê§ Ê¨ Ê© Êª Ê« Ê¬ Ê­ Ê® Ê¯ Ê° Ê± Ê² Ê³ Ê´ Êµ Ê¶ Ê· Ê¸ Ê¹ Êº Ê» Ê¼ Ê½ Ê¾ Ê¿'
            +'u02C0: Ë€ Ë Ë‚ Ëƒ Ë„ Ë… Ë† Ë‡ Ëˆ Ë‰ ËŠ Ë‹ ËŒ Ë Ë Ë Ë Ë‘ Ë’ Ë“ Ë” Ë• Ë– Ë— Ë˜ Ë™ Ëš Ë› Ëœ Ë Ë ËŸ'
            +'u02E0: Ë  Ë¡ Ë¢ Ë£ Ë¤ Ë¥ Ë¦ Ë§ Ë¨ Ë© Ëª Ë« Ë¬ Ë­ Ë® Ë¯ Ë° Ë± Ë² Ë³ Ë´ Ëµ Ë¶ Ë· Ë¸ Ë¹ Ëº Ë» Ë¼ Ë½ Ë¾ Ë¿'
            +'u0300: Ì€ Ì Ì‚ Ìƒ Ì„ Ì… Ì† Ì‡ Ìˆ Ì‰ ÌŠ Ì‹ ÌŒ Ì Ì Ì Ì Ì‘ Ì’ Ì“ Ì” Ì• Ì– Ì— Ì˜ Ì™ Ìš Ì› Ìœ Ì Ì ÌŸ'
            +'u0320: Ì  Ì¡ Ì¢ Ì£ Ì¤ Ì¥ Ì¦ Ì§ Ì¨ Ì© Ìª Ì« Ì¬ Ì­ Ì® Ì¯ Ì° Ì± Ì² Ì³ Ì´ Ìµ Ì¶ Ì· Ì¸ Ì¹ Ìº Ì» Ì¼ Ì½ Ì¾ Ì¿'
            +'u0340: Ì€ Ì Í‚ Ì“ ÌˆÌ Í… Í† Í‡ Íˆ Í‰ ÍŠ Í‹ ÍŒ Í Í Í Í Í‘ Í’ Í“ Í” Í• Í– Í— Í˜ Í™ Íš Í› Íœ Í Í ÍŸ'
            +'u0360: Í  Í¡ Í¢ Í£ Í¤ Í¥ Í¦ Í§ Í¨ Í© Íª Í« Í¬ Í­ Í® Í¯ Í° Í± Í² Í³ Ê¹ Íµ Í¶ Í· Í¸ Í¹ Íº Í» Í¼ Í½ ; Í¿'
            +'u0380: Î€ Î Î‚ Îƒ Î„ Î… Î† Â· Îˆ Î‰ ÎŠ Î‹ ÎŒ Î Î Î Î Î‘ Î’ Î“ Î” Î• Î– Î— Î˜ Î™ Îš Î› Îœ Î Î ÎŸ'
            +'u03A0: Î  Î¡ Î¢ Î£ Î¤ Î¥ Î¦ Î§ Î¨ Î© Îª Î« Î¬ Î­ Î® Î¯ Î° Î± Î² Î³ Î´ Îµ Î¶ Î· Î¸ Î¹ Îº Î» Î¼ Î½ Î¾ Î¿'
            +'u03C0: Ï€ Ï Ï‚ Ïƒ Ï„ Ï… Ï† Ï‡ Ïˆ Ï‰ ÏŠ Ï‹ ÏŒ Ï Ï Ï Ï Ï‘ Ï’ Ï“ Ï” Ï• Ï– Ï— Ï˜ Ï™ Ïš Ï› Ïœ Ï Ï ÏŸ'
            +'u03E0: Ï  Ï¡ Ï¢ Ï£ Ï¤ Ï¥ Ï¦ Ï§ &#:00; Ï© Ïª Ï« Ï¬ Ï­ Ï® Ï¯ Ï° Ï± Ï² Ï³ Ï´ Ïµ Ï¶ Ï· Ï¸ Ï¹ Ïº Ï» Ï¼ Ï½ Ï¾ Ï¿'
            +'u0400: Ğ€ Ğ Ğ‚ Ğƒ Ğ„ Ğ… Ğ† Ğ‡ Ğˆ Ğ‰ ĞŠ Ğ‹ ĞŒ Ğ Ğ Ğ Ğ Ğ‘ Ğ’ Ğ“ Ğ” Ğ• Ğ– Ğ— Ğ˜ Ğ™ Ğš Ğ› Ğœ Ğ Ğ ĞŸ'
            +'u0420: Ğ  Ğ¡ Ğ¢ Ğ£ Ğ¤ Ğ¥ Ğ¦ Ğ§ Ğ¨ Ğ© Ğª Ğ« Ğ¬ Ğ­ Ğ® Ğ¯ Ğ° Ğ± Ğ² Ğ³ Ğ´ Ğµ Ğ¶ Ğ· Ğ¸ Ğ¹ Ğº Ğ» Ğ¼ Ğ½ Ğ¾ Ğ¿'
            +'u0440: Ñ€ Ñ Ñ‚ Ñƒ Ñ„ Ñ… Ñ† Ñ‡ Ñˆ Ñ‰ ÑŠ Ñ‹ ÑŒ Ñ Ñ Ñ Ñ Ñ‘ Ñ’ Ñ“ Ñ” Ñ• Ñ– Ñ— Ñ˜ Ñ™ Ñš Ñ› Ñœ Ñ Ñ ÑŸ'
            +'u0460: Ñ  Ñ¡ Ñ¢ Ñ£ Ñ¤ Ñ¥ Ñ¦ Ñ§ Ñ¨ Ñ© Ñª Ñ« Ñ¬ Ñ­ Ñ® Ñ¯ Ñ° Ñ± Ñ² Ñ³ Ñ´ Ñµ Ñ¶ Ñ· Ñ¸ Ñ¹ Ñº Ñ» Ñ¼ Ñ½ Ñ¾ Ñ¿'
            +'u0480: Ò€ Ò Ò‚ Òƒ Ò„ Ò… Ò† Ò‡ Òˆ Ò‰ ÒŠ Ò‹ ÒŒ Ò Ò Ò Ò Ò‘ Ò’ Ò“ Ò” Ò• Ò– Ò— Ò˜ Ò™ Òš Ò› Òœ Ò Ò ÒŸu04A0: Ò  Ò¡ Ò¢ Ò£ Ò¤ Ò¥ Ò¦ Ò§ Ò¨ Ò© Òª Ò« Ò¬ Ò­ Ò® Ò¯ Ò° Ò± Ò² Ò³ Ò´ Òµ Ò¶ Ò· Ò¸ Ò¹ Òº Ò» Ò¼ Ò½ Ò¾ Ò¿'
            +'u04C0: Ó€ Ó Ó‚ Óƒ Ó„ Ó… Ó† Ó‡ Óˆ Ó‰ ÓŠ Ó‹ ÓŒ Ó Ó Ó Ó Ó‘ Ó’ Ó“ Ó” Ó• Ó– Ó— Ó˜ Ó™ Óš Ó› Óœ Ó Ó ÓŸ'
            +'u04E0: Ó  Ó¡ Ó¢ Ó£ Ó¤ Ó¥ Ó¦ Ó§ Ó¨ Ó© Óª Ó« Ó¬ Ó­ Ó® Ó¯ Ó° Ó± Ó² Ó³ Ó´ Óµ Ó¶ Ó· Ó¸ Ó¹ Óº Ó» Ó¼ Ó½ Ó¾ Ó¿'
            +'u0500: Ô€ Ô Ô‚ Ôƒ Ô„ Ô… Ô† Ô‡ Ôˆ Ô‰ ÔŠ Ô‹ ÔŒ Ô Ô Ô Ô Ô‘ Ô’ Ô“ Ô” Ô• Ô– Ô— Ô˜ Ô™ Ôš Ô› Ôœ Ô Ô ÔŸ'
            +'u0520: Ô  Ô¡ Ô¢ Ô£ Ô¤ Ô¥ Ô¦ Ô§ Ô¨ Ô© Ôª Ô« Ô¬ Ô­ Ô® Ô¯ Ô° Ô± Ô² Ô³ Ô´ Ôµ Ô¶ Ô· Ô¸ Ô¹ Ôº Ô» Ô¼ Ô½ Ô¾ Ô¿'
            +'u0620: Ø Ø¡ Ø¢ Ø£ Ø¤ Ø¥ Ø¦ Ø§ Ø¨ Ø© Øª Ø« Ø¬ Ø­ Ø® Ø¯ Ø° Ø± Ø² Ø³ Ø´ Øµ Ø¶ Ø· Ø¸ Ø¹ Øº Ø» Ø¼ Ø½ Ø¾ Ø¿'
            +'u0640: Ù€ Ù Ù‚ Ùƒ Ù„ Ù… Ù† Ù‡ Ùˆ Ù‰ ÙŠ Ù‹ ÙŒ Ù Ù Ù Ù Ù‘ Ù’ Ù“ Ù” Ù• Ù– Ù— Ù˜ Ù™ Ùš Ù› Ùœ Ù Ù ÙŸ'
            +'u0660: Ù  Ù¡ Ù¢ Ù£ Ù¤ Ù¥ Ù¦ Ù§ Ù¨ Ù© Ùª Ù« Ù¬ Ù­ Ù® Ù¯ Ù° Ù± Ù² Ù³ Ù´ Ùµ Ù¶ Ù· Ù¸ Ù¹ Ùº Ù» Ù¼ Ù½ Ù¾ Ù¿'
            +'u0680: Ú€ Ú Ú‚ Úƒ Ú„ Ú… Ú† Ú‡ Úˆ Ú‰ ÚŠ Ú‹ ÚŒ Ú Ú Ú Ú Ú‘ Ú’ Ú“ Ú” Ú• Ú– Ú— Ú˜ Ú™ Úš Ú› Úœ Ú Ú ÚŸ'
            +'u0900: à¤€ à¤ à¤‚ à¤ƒ à¤„ à¤… à¤† à¤‡ à¤ˆ à¤‰ à¤Š à¤‹ à¤Œ à¤ à¤ à¤ à¤ à¤‘ à¤’ à¤“ à¤” à¤• à¤– à¤— à¤˜ à¤™ à¤š à¤› à¤œ à¤ à¤ à¤Ÿ'
            +'u0920: à¤  à¤¡ à¤¢ à¤£ à¤¤ à¤¥ à¤¦ à¤§ à¤¨ à¤© à¤ª à¤« à¤¬ à¤­ à¤® à¤¯ à¤° à¤± à¤² à¤³ à¤´ à¤µ à¤¶ à¤· à¤¸ à¤¹ à¤º à¤» à¤¼ à¤½ à¤¾ à¤¿'
            +'u0940: à¥€ à¥ à¥‚ à¥ƒ à¥„ à¥… à¥† à¥‡ à¥ˆ à¥‰ à¥Š à¥‹ à¥Œ à¥ à¥ à¥ à¥ à¥‘ à¥’ à¥“ à¥” à¥• à¥– à¥— à¤•à¤¼ à¤–à¤¼ à¤—à¤¼ à¤œà¤¼ à¤¡à¤¼ à¤¢à¤¼ à¤«à¤¼ à¤¯à¤¼'
            +'u0FC0: à¿€ à¿ à¿‚ à¿ƒ à¿„ à¿… à¿† à¿‡ à¿ˆ à¿‰ à¿Š à¿‹ à¿Œ à¿ à¿ à¿ à¿ à¿‘ à¿’ à¿“ à¿” à¿• à¿– à¿— à¿˜ à¿™ à¿š à¿› à¿œ à¿ à¿ à¿Ÿ'
            +'u10A0: á‚  á‚¡ á‚¢ á‚£ á‚¤ á‚¥ á‚¦ á‚§ á‚¨ á‚© á‚ª á‚« á‚¬ á‚­ á‚® á‚¯ á‚° á‚± á‚² á‚³ á‚´ á‚µ á‚¶ á‚· á‚¸ á‚¹ á‚º á‚» á‚¼ á‚½ á‚¾ á‚¿'
            +'u13A0: á  á¡ á¢ á£ á¤ á¥ á¦ á§ á¨ á© áª á« á¬ á­ á® á¯ á° á± á² á³ á´ áµ á¶ á· á¸ á¹ áº á» á¼ á½ á¾ á¿'
            +'u1400: á€ á á‚ áƒ á„ á… á† á‡ áˆ á‰ áŠ á‹ áŒ á á á á á‘ á’ á“ á” á• á– á— á˜ á™ áš á› áœ á á áŸ'
            +'u1580: á–€ á– á–‚ á–ƒ á–„ á–… á–† á–‡ á–ˆ á–‰ á–Š á–‹ á–Œ á– á– á– á– á–‘ á–’ á–“ á–” á–• á–– á–— á–˜ á–™ á–š á–› á–œ á– á– á–Ÿ'
            +'u1680: áš€ áš áš‚ ášƒ áš„ áš… áš† áš‡ ášˆ áš‰ ášŠ áš‹ ášŒ áš áš áš áš áš‘ áš’ áš“ áš” áš• áš– áš— áš˜ áš™ ášš áš› ášœ áš áš ášŸ'
            +'u16A0: áš  áš¡ áš¢ áš£ áš¤ áš¥ áš¦ áš§ áš¨ áš© ášª áš« áš¬ áš­ áš® áš¯ áš° áš± áš² áš³ áš´ ášµ áš¶ áš· áš¸ áš¹ ášº áš» áš¼ áš½ áš¾ áš¿'
            +'u16C0: á›€ á› á›‚ á›ƒ á›„ á›… á›† á›‡ á›ˆ á›‰ á›Š á›‹ á›Œ á› á› á› á› á›‘ á›’ á›“ á›” á›• á›– á›— á›˜ á›™ á›š á›› á›œ á› á› á›Ÿ'
            +'u16E0: á›  á›¡ á›¢ á›£ á›¤ á›¥ á›¦ á›§ á›¨ á›© á›ª á›« á›¬ á›­ á›® á›¯ á›° á›± á›² á›³ á›´ á›µ á›¶ á›· á›¸ á›¹ á›º á›» á›¼ á›½ á›¾ á›¿'
            +'u1D00: á´€ á´ á´‚ á´ƒ á´„ á´… á´† á´‡ á´ˆ á´‰ á´Š á´‹ á´Œ á´ á´ á´ á´ á´‘ á´’ á´“ á´” á´• á´– á´— á´˜ á´™ á´š á´› á´œ á´ á´ á´Ÿ'
            +'u1D20: á´  á´¡ á´¢ á´£ á´¤ á´¥ á´¦ á´§ á´¨ á´© á´ª á´« á´¬ á´­ á´® á´¯ á´° á´± á´² á´³ á´´ á´µ á´¶ á´· á´¸ á´¹ á´º á´» á´¼ á´½ á´¾ á´¿'
            +'u1D40: áµ€ áµ áµ‚ áµƒ áµ„ áµ… áµ† áµ‡ áµˆ áµ‰ áµŠ áµ‹ áµŒ áµ áµ áµ áµ áµ‘ áµ’ áµ“ áµ” áµ• áµ– áµ— áµ˜ áµ™ áµš áµ› áµœ áµ áµ áµŸ'
            +'u1E00: á¸€ á¸ á¸‚ á¸ƒ á¸„ á¸… á¸† á¸‡ á¸ˆ á¸‰ á¸Š á¸‹ á¸Œ á¸ á¸ á¸ á¸ á¸‘ á¸’ á¸“ á¸” á¸• á¸– á¸— á¸˜ á¸™ á¸š á¸› á¸œ á¸ á¸ á¸Ÿ'
            +'u1E20: á¸  á¸¡ á¸¢ á¸£ á¸¤ á¸¥ á¸¦ á¸§ á¸¨ á¸© á¸ª á¸« á¸¬ á¸­ á¸® á¸¯ á¸° á¸± á¸² á¸³ á¸´ á¸µ á¸¶ á¸· á¸¸ á¸¹ á¸º á¸» á¸¼ á¸½ á¸¾ á¸¿'
            +'u1E40: á¹€ á¹ á¹‚ á¹ƒ á¹„ á¹… á¹† á¹‡ á¹ˆ á¹‰ á¹Š á¹‹ á¹Œ á¹ á¹ á¹ á¹ á¹‘ á¹’ á¹“ á¹” á¹• á¹– á¹— á¹˜ á¹™ á¹š á¹› á¹œ á¹ á¹ á¹Ÿ'
            +'u1E60: á¹  á¹¡ á¹¢ á¹£ á¹¤ á¹¥ á¹¦ á¹§ á¹¨ á¹© á¹ª á¹« á¹¬ á¹­ á¹® á¹¯ á¹° á¹± á¹² á¹³ á¹´ á¹µ á¹¶ á¹· á¹¸ á¹¹ á¹º á¹» á¹¼ á¹½ á¹¾ á¹¿'
            +'u1E80: áº€ áº áº‚ áºƒ áº„ áº… áº† áº‡ áºˆ áº‰ áºŠ áº‹ áºŒ áº áº áº áº áº‘ áº’ áº“ áº” áº• áº– áº— áº˜ áº™ áºš áº› áºœ áº áº áºŸ'
            +'u1EA0: áº  áº¡ áº¢ áº£ áº¤ áº¥ áº¦ áº§ áº¨ áº© áºª áº« áº¬ áº­ áº® áº¯ áº° áº± áº² áº³ áº´ áºµ áº¶ áº· áº¸ áº¹ áºº áº» áº¼ áº½ áº¾ áº¿'
            +'u1EC0: á»€ á» á»‚ á»ƒ á»„ á»… á»† á»‡ á»ˆ á»‰ á»Š á»‹ á»Œ á» á» á» á» á»‘ á»’ á»“ á»” á»• á»– á»— á»˜ á»™ á»š á»› á»œ á» á» á»Ÿ'
            +'u1EE0: á»  á»¡ á»¢ á»£ á»¤ á»¥ á»¦ á»§ á»¨ á»© á»ª á»« á»¬ á»­ á»® á»¯ á»° á»± á»² á»³ á»´ á»µ á»¶ á»· á»¸ á»¹ á»º á»» á»¼ á»½ á»¾ á»¿'
            +'u1F00: á¼€ á¼ á¼‚ á¼ƒ á¼„ á¼… á¼† á¼‡ á¼ˆ á¼‰ á¼Š á¼‹ á¼Œ á¼ á¼ á¼ á¼ á¼‘ á¼’ á¼“ á¼” á¼• á¼– á¼— á¼˜ á¼™ á¼š á¼› á¼œ á¼ á¼ á¼Ÿ'
            +'u1F20: á¼  á¼¡ á¼¢ á¼£ á¼¤ á¼¥ á¼¦ á¼§ á¼¨ á¼© á¼ª á¼« á¼¬ á¼­ á¼® á¼¯ á¼° á¼± á¼² á¼³ á¼´ á¼µ á¼¶ á¼· á¼¸ á¼¹ á¼º á¼» á¼¼ á¼½ á¼¾ á¼¿'
            +'u1F40: á½€ á½ á½‚ á½ƒ á½„ á½… á½† á½‡ á½ˆ á½‰ á½Š á½‹ á½Œ á½ á½ á½ á½ á½‘ á½’ á½“ á½” á½• á½– á½— á½˜ á½™ á½š á½› á½œ á½ á½ á½Ÿ'
            +'u1F60: á½  á½¡ á½¢ á½£ á½¤ á½¥ á½¦ á½§ á½¨ á½© á½ª á½« á½¬ á½­ á½® á½¯ á½° Î¬ á½² Î­ á½´ Î® á½¶ Î¯ á½¸ ÏŒ á½º Ï á½¼ Ï á½¾ á½¿'
            +'u1F80: á¾€ á¾ á¾‚ á¾ƒ á¾„ á¾… á¾† á¾‡ á¾ˆ á¾‰ á¾Š á¾‹ á¾Œ á¾ á¾ á¾ á¾ á¾‘ á¾’ á¾“ á¾” á¾• á¾– á¾— á¾˜ á¾™ á¾š á¾› á¾œ á¾ á¾ á¾Ÿ'
            +'u1FA0: á¾  á¾¡ á¾¢ á¾£ á¾¤ á¾¥ á¾¦ á¾§ á¾¨ á¾© á¾ª á¾« á¾¬ á¾­ á¾® á¾¯ á¾° á¾± á¾² á¾³ á¾´ á¾µ á¾¶ á¾· á¾¸ á¾¹ á¾º Î† á¾¼ á¾½ Î¹ á¾¿'
            +'u1FC0: á¿€ á¿ á¿‚ á¿ƒ á¿„ á¿… á¿† á¿‡ á¿ˆ Îˆ á¿Š Î‰ á¿Œ á¿ á¿ á¿ á¿ á¿‘ á¿’ Î á¿” á¿• á¿– á¿— á¿˜ á¿™ á¿š ÎŠ á¿œ á¿ á¿ á¿Ÿ'
            +'u1FE0: á¿  á¿¡ á¿¢ Î° á¿¤ á¿¥ á¿¦ á¿§ á¿¨ á¿© á¿ª Î á¿¬ á¿­ Î… ` á¿° á¿± á¿² á¿³ á¿´ á¿µ á¿¶ á¿· á¿¸ ÎŒ á¿º Î á¿¼ Â´ á¿¾ á¿¿'
            +'u2000: â€‚ â€ƒ â€‚ â€ƒ â€„ â€… â€† â€‡ â€ˆ â€‰ â€Š  â€Œ â€ â€ â€ â€ â€‘ â€’ â€“ â€” â€• â€– â€— â€˜ â€™ â€š â€› â€œ â€ â€ â€Ÿ'
            +'u2020:â€  â€¡ â€¢ â€£ â€¤ â€¥ â€¦ â€§\u2029\u2028 â€­ â€® â€¯ â€° â€± â€² â€³ â€´ â€µ â€¶ â€· â€¸ â€¹ â€º â€» â€¼ â€½ â€¾ â€¿'
            +'u2040: â€ â â‚ âƒ â„ â… â† â‡ âˆ â‰ âŠ â‹ âŒ â â â â â‘ â’ â“ â” â• â– â— â˜ â™ âš â› âœ â â âŸ'
            +'u2060: â  â¡ â¢ â£ â¤ â¥ â¦ â§ â¨ â©       â° â± â² â³ â´ âµ â¶ â· â¸ â¹ âº â» â¼ â½ â¾ â¿'
            +'u2080: â‚€ â‚ â‚‚ â‚ƒ â‚„ â‚… â‚† â‚‡ â‚ˆ â‚‰ â‚Š â‚‹ â‚Œ â‚ â‚ â‚ â‚ â‚‘ â‚’ â‚“ â‚” â‚• â‚– â‚— â‚˜ â‚™ â‚š â‚› â‚œ â‚ â‚ â‚Ÿ'
            +'u20A0: â‚  â‚¡ â‚¢ â‚£ â‚¤ â‚¥ â‚¦ â‚§ â‚¨ â‚© â‚ª â‚« â‚¬ â‚­ â‚® â‚¯ â‚° â‚± â‚² â‚³ â‚´ â‚µ â‚¶ â‚· â‚¸ â‚¹ â‚º â‚» â‚¼ â‚½ â‚¾ â‚¿'
            +'u20C0: âƒ€ âƒ âƒ‚ âƒƒ âƒ„ âƒ… âƒ† âƒ‡ âƒˆ âƒ‰ âƒŠ âƒ‹ âƒŒ âƒ âƒ âƒ âƒ âƒ‘ âƒ’ âƒ“ âƒ” âƒ• âƒ– âƒ— âƒ˜ âƒ™ âƒš âƒ› âƒœ âƒ âƒ âƒŸ'
            +'u20E0: âƒ  âƒ¡ âƒ¢ âƒ£ âƒ¤ âƒ¥ âƒ¦ âƒ§ âƒ¨ âƒ© âƒª âƒ« âƒ¬ âƒ­ âƒ® âƒ¯ âƒ° âƒ± âƒ² âƒ³ âƒ´ âƒµ âƒ¶ âƒ· âƒ¸ âƒ¹ âƒº âƒ» âƒ¼ âƒ½ âƒ¾ âƒ¿'
            +'u2100: â„€ â„ â„‚ â„ƒ â„„ â„… â„† â„‡ â„ˆ â„‰ â„Š â„‹ â„Œ â„ â„ â„ â„ â„‘ â„’ â„“ â„” â„• â„– â„— â„˜ â„™ â„š â„› â„œ â„ â„ â„Ÿ'
            +'u2120: â„  â„¡ â„¢ â„£ â„¤ â„¥ Î© â„§ â„¨ â„© K Ã… â„¬ â„­ â„® â„¯ â„° â„± â„² â„³ â„´ â„µ â„¶ â„· â„¸ â„¹ â„º â„» â„¼ â„½ â„¾ â„¿'
            +'u2140: â…€ â… â…‚ â…ƒ â…„ â…… â…† â…‡ â…ˆ â…‰ â…Š â…‹ â…Œ â… â… â… â… â…‘ â…’ â…“ â…” â…• â…– â…— â…˜ â…™ â…š â…› â…œ â… â… â…Ÿ'
            +'u2160: â…  â…¡ â…¢ â…£ â…¤ â…¥ â…¦ â…§ â…¨ â…© â…ª â…« â…¬ â…­ â…® â…¯ â…° â…± â…² â…³ â…´ â…µ â…¶ â…· â…¸ â…¹ â…º â…» â…¼ â…½ â…¾ â…¿'
            +'u2180: â†€ â† â†‚ â†ƒ â†„ â†… â†† â†‡ â†ˆ â†‰ â†Š â†‹ â†Œ â† â† â† â† â†‘ â†’ â†“ â†” â†• â†– â†— â†˜ â†™ â†š â†› â†œ â† â† â†Ÿ'
            +'u21A0: â†  â†¡ â†¢ â†£ â†¤ â†¥ â†¦ â†§ â†¨ â†© â†ª â†« â†¬ â†­ â†® â†¯ â†° â†± â†² â†³ â†´ â†µ â†¶ â†· â†¸ â†¹ â†º â†» â†¼ â†½ â†¾ â†¿'
            +'u21C0: â‡€ â‡ â‡‚ â‡ƒ â‡„ â‡… â‡† â‡‡ â‡ˆ â‡‰ â‡Š â‡‹ â‡Œ â‡ â‡ â‡ â‡ â‡‘ â‡’ â‡“ â‡” â‡• â‡– â‡— â‡˜ â‡™ â‡š â‡› â‡œ â‡ â‡ â‡Ÿ'
            +'u21E0: â‡  â‡¡ â‡¢ â‡£ â‡¤ â‡¥ â‡¦ â‡§ â‡¨ â‡© â‡ª â‡« â‡¬ â‡­ â‡® â‡¯ â‡° â‡± â‡² â‡³ â‡´ â‡µ â‡¶ â‡· â‡¸ â‡¹ â‡º â‡» â‡¼ â‡½ â‡¾ â‡¿'
            +'u2200: âˆ€ âˆ âˆ‚ âˆƒ âˆ„ âˆ… âˆ† âˆ‡ âˆˆ âˆ‰ âˆŠ âˆ‹ âˆŒ âˆ âˆ âˆ âˆ âˆ‘ âˆ’ âˆ“ âˆ” âˆ• âˆ– âˆ— âˆ˜ âˆ™ âˆš âˆ› âˆœ âˆ âˆ âˆŸ'
            +'u2220: âˆ  âˆ¡ âˆ¢ âˆ£ âˆ¤ âˆ¥ âˆ¦ âˆ§ âˆ¨ âˆ© âˆª âˆ« âˆ¬ âˆ­ âˆ® âˆ¯ âˆ° âˆ± âˆ² âˆ³ âˆ´ âˆµ âˆ¶ âˆ· âˆ¸ âˆ¹ âˆº âˆ» âˆ¼ âˆ½ âˆ¾ âˆ¿'
            +'u2240: â‰€ â‰ â‰‚ â‰ƒ â‰„ â‰… â‰† â‰‡ â‰ˆ â‰‰ â‰Š â‰‹ â‰Œ â‰ â‰ â‰ â‰ â‰‘ â‰’ â‰“ â‰” â‰• â‰– â‰— â‰˜ â‰™ â‰š â‰› â‰œ â‰ â‰ â‰Ÿ'
            +'u2260: â‰  â‰¡ â‰¢ â‰£ â‰¤ â‰¥ â‰¦ â‰§ â‰¨ â‰© â‰ª â‰« â‰¬ â‰­ â‰® â‰¯ â‰° â‰± â‰² â‰³ â‰´ â‰µ â‰¶ â‰· â‰¸ â‰¹ â‰º â‰» â‰¼ â‰½ â‰¾ â‰¿'
            +'u2280: âŠ€ âŠ âŠ‚ âŠƒ âŠ„ âŠ… âŠ† âŠ‡ âŠˆ âŠ‰ âŠŠ âŠ‹ âŠŒ âŠ âŠ âŠ âŠ âŠ‘ âŠ’ âŠ“ âŠ” âŠ• âŠ– âŠ— âŠ˜ âŠ™ âŠš âŠ› âŠœ âŠ âŠ âŠŸ'
            +'u22A0: âŠ  âŠ¡ âŠ¢ âŠ£ âŠ¤ âŠ¥ âŠ¦ âŠ§ âŠ¨ âŠ© âŠª âŠ« âŠ¬ âŠ­ âŠ® âŠ¯ âŠ° âŠ± âŠ² âŠ³ âŠ´ âŠµ âŠ¶ âŠ· âŠ¸ âŠ¹ âŠº âŠ» âŠ¼ âŠ½ âŠ¾ âŠ¿'
            +'u22C0: â‹€ â‹ â‹‚ â‹ƒ â‹„ â‹… â‹† â‹‡ â‹ˆ â‹‰ â‹Š â‹‹ â‹Œ â‹ â‹ â‹ â‹ â‹‘ â‹’ â‹“ â‹” â‹• â‹– â‹— â‹˜ â‹™ â‹š â‹› â‹œ â‹ â‹ â‹Ÿ'
            +'u22E0: â‹  â‹¡ â‹¢ â‹£ â‹¤ â‹¥ â‹¦ â‹§ â‹¨ â‹© â‹ª â‹« â‹¬ â‹­ â‹® â‹¯ â‹° â‹± â‹² â‹³ â‹´ â‹µ â‹¶ â‹· â‹¸ â‹¹ â‹º â‹» â‹¼ â‹½ â‹¾ â‹¿'
            +'u2300: âŒ€ âŒ âŒ‚ âŒƒ âŒ„ âŒ… âŒ† âŒ‡ âŒˆ âŒ‰ âŒŠ âŒ‹ âŒŒ âŒ âŒ âŒ âŒ âŒ‘ âŒ’ âŒ“ âŒ” âŒ• âŒ– âŒ— âŒ˜ âŒ™ âŒš âŒ› âŒœ âŒ âŒ âŒŸ'
            +'u2320: âŒ  âŒ¡ âŒ¢ âŒ£ âŒ¤ âŒ¥ âŒ¦ âŒ§ âŒ¨ ã€ˆ ã€‰ âŒ« âŒ¬ âŒ­ âŒ® âŒ¯ âŒ° âŒ± âŒ² âŒ³ âŒ´ âŒµ âŒ¶ âŒ· âŒ¸ âŒ¹ âŒº âŒ» âŒ¼ âŒ½ âŒ¾ âŒ¿'
            +'u2340: â€ â â‚ âƒ â„ â… â† â‡ âˆ â‰ âŠ â‹ âŒ â â â â â‘ â’ â“ â” â• â– â— â˜ â™ âš â› âœ â â âŸ'
            +'u2360: â  â¡ â¢ â£ â¤ â¥ â¦ â§ â¨ â© âª â« â¬ â­ â® â¯ â° â± â² â³ â´ âµ â¶ â· â¸ â¹ âº â» â¼ â½ â¾ â¿'
            +'u2380: â€ â â‚ âƒ â„ â… â† â‡ âˆ â‰ âŠ â‹ âŒ â â â â â‘ â’ â“ â” â• â– â— â˜ â™ âš â› âœ â â âŸ'
            +'u23A0: â  â¡ â¢ â£ â¤ â¥ â¦ â§ â¨ â© âª â« â¬ â­ â® â¯ â° â± â² â³ â´ âµ â¶ â· â¸ â¹ âº â» â¼ â½ â¾ â¿'
            +'u23C0: â€ â â‚ âƒ â„ â… â† â‡ âˆ â‰ âŠ â‹ âŒ â â â â â‘ â’ â“ â” â• â– â— â˜ â™ âš â› âœ â â âŸ';
        legacynote.body=body;
        legacynote.parentId=c.Id; 
        legacynote.OwnerId = UserInfo.getUserId();
        legacynote.CreatedDate = Date.today();
        
        insert legacynote;
        
        List<String> resultAux = new List<String>();
        //get the ids
        resultAux.add(legacynote.Id);        
        Test.startTest();
        //run the migration by Ids  
        NMTMigratorBatch batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today(), true);
        Id batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
   
        Test.stopTest();
        
        List<NAMNoteConverted__c> contentVersions = [SELECT Id FROM NAMNoteConverted__C WHERE LegacyNoteConvertedId__c in :resultAux];
        //assert 1 contentVersion was created
        System.assertEquals(1, contentVersions.size(), '1 Content Note created');
        
        List<ContentDocumentLink> cdls = [SELECT Id FROM ContentDocumentLink WHERE
                                          linkedEntityId = :c.Id
                                          AND
                                          contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c in :resultAux];
        //assert 1 CDL was created
        System.assertEquals(1, cdls.size(), '1 Content Note linked to the parent Contact');
        }
    }
    
       /**
* @description tests notes migration with invalid characters
* Test Case Name: Migrate note that has special characters
*/    
   
    @isTest
    static void testNotestMigrationInvalidCharacters2(){
        if(NAMUtils.isEnhancedNotesEnabled()||NAMUtils.ENABLE_NOTES_TESTS){
        Contact c = NMTTestNoteUtils.createContact();
        //create a legacy note
        Note legacynote = new Note();
        legacynote.Title='noteTitle';
        String body = 'u23E0: â  â¡ â¢ â£ â¤ â¥ â¦ â§ â¨ â© âª â« â¬ â­ â® â¯ â° â± â² â³ â´ âµ â¶ â· â¸ â¹ âº â» â¼ â½ â¾ â¿'
            +'u2400: â€ â â‚ âƒ â„ â… â† â‡ âˆ â‰ âŠ â‹ âŒ â â â â â‘ â’ â“ â” â• â– â— â˜ â™ âš â› âœ â â âŸ'
            +'u2420: â  â¡ â¢ â£ â¤ â¥ â¦ â§ â¨ â© âª â« â¬ â­ â® â¯ â° â± â² â³ â´ âµ â¶ â· â¸ â¹ âº â» â¼ â½ â¾ â¿'
            +'u2440: â‘€ â‘ â‘‚ â‘ƒ â‘„ â‘… â‘† â‘‡ â‘ˆ â‘‰ â‘Š â‘‹ â‘Œ â‘ â‘ â‘ â‘ â‘‘ â‘’ â‘“ â‘” â‘• â‘– â‘— â‘˜ â‘™ â‘š â‘› â‘œ â‘ â‘ â‘Ÿ'
            +'u2460: â‘  â‘¡ â‘¢ â‘£ â‘¤ â‘¥ â‘¦ â‘§ â‘¨ â‘© â‘ª â‘« â‘¬ â‘­ â‘® â‘¯ â‘° â‘± â‘² â‘³ â‘´ â‘µ â‘¶ â‘· â‘¸ â‘¹ â‘º â‘» â‘¼ â‘½ â‘¾ â‘¿'
            +'u2480: â’€ â’ â’‚ â’ƒ â’„ â’… â’† â’‡ â’ˆ â’‰ â’Š â’‹ â’Œ â’ â’ â’ â’ â’‘ â’’ â’“ â’” â’• â’– â’— â’˜ â’™ â’š â’› â’œ â’ â’ â’Ÿ'
            +'u24A0: â’  â’¡ â’¢ â’£ â’¤ â’¥ â’¦ â’§ â’¨ â’© â’ª â’« â’¬ â’­ â’® â’¯ â’° â’± â’² â’³ â’´ â’µ â’¶ â’· â’¸ â’¹ â’º â’» â’¼ â’½ â’¾ â’¿'
            +'u24C0: â“€ â“ â“‚ â“ƒ â“„ â“… â“† â“‡ â“ˆ â“‰ â“Š â“‹ â“Œ â“ â“ â“ â“ â“‘ â“’ â““ â“” â“• â“– â“— â“˜ â“™ â“š â“› â“œ â“ â“ â“Ÿ'
            +'u24E0: â“  â“¡ â“¢ â“£ â“¤ â“¥ â“¦ â“§ â“¨ â“© â“ª â“« â“¬ â“­ â“® â“¯ â“° â“± â“² â“³ â“´ â“µ â“¶ â“· â“¸ â“¹ â“º â“» â“¼ â“½ â“¾ â“¿'
            +'u2500: â”€ â” â”‚ â”ƒ â”„ â”… â”† â”‡ â”ˆ â”‰ â”Š â”‹ â”Œ â” â” â” â” â”‘ â”’ â”“ â”” â”• â”– â”— â”˜ â”™ â”š â”› â”œ â” â” â”Ÿ'
            +'u2520: â”  â”¡ â”¢ â”£ â”¤ â”¥ â”¦ â”§ â”¨ â”© â”ª â”« â”¬ â”­ â”® â”¯ â”° â”± â”² â”³ â”´ â”µ â”¶ â”· â”¸ â”¹ â”º â”» â”¼ â”½ â”¾ â”¿'
            +'u2540: â•€ â• â•‚ â•ƒ â•„ â•… â•† â•‡ â•ˆ â•‰ â•Š â•‹ â•Œ â• â• â• â• â•‘ â•’ â•“ â•” â•• â•– â•— â•˜ â•™ â•š â•› â•œ â• â• â•Ÿ'
            +'u2560: â•  â•¡ â•¢ â•£ â•¤ â•¥ â•¦ â•§ â•¨ â•© â•ª â•« â•¬ â•­ â•® â•¯ â•° â•± â•² â•³ â•´ â•µ â•¶ â•· â•¸ â•¹ â•º â•» â•¼ â•½ â•¾ â•¿'
            +'u2580: â–€ â– â–‚ â–ƒ â–„ â–… â–† â–‡ â–ˆ â–‰ â–Š â–‹ â–Œ â– â– â– â– â–‘ â–’ â–“ â–” â–• â–– â–— â–˜ â–™ â–š â–› â–œ â– â– â–Ÿ'
            +'u25A0: â–  â–¡ â–¢ â–£ â–¤ â–¥ â–¦ â–§ â–¨ â–© â–ª â–« â–¬ â–­ â–® â–¯ â–° â–± â–² â–³ â–´ â–µ â–¶ â–· â–¸ â–¹ â–º â–» â–¼ â–½ â–¾ â–¿'
            +'u25C0: â—€ â— â—‚ â—ƒ â—„ â—… â—† â—‡ â—ˆ â—‰ â—Š â—‹ â—Œ â— â— â— â— â—‘ â—’ â—“ â—” â—• â—– â—— â—˜ â—™ â—š â—› â—œ â— â— â—Ÿ'
            +'u25E0: â—  â—¡ â—¢ â—£ â—¤ â—¥ â—¦ â—§ â—¨ â—© â—ª â—« â—¬ â—­ â—® â—¯ â—° â—± â—² â—³ â—´ â—µ â—¶ â—· â—¸ â—¹ â—º â—» â—¼ â—½ â—¾ â—¿'
            +'u2600: â˜€ â˜ â˜‚ â˜ƒ â˜„ â˜… â˜† â˜‡ â˜ˆ â˜‰ â˜Š â˜‹ â˜Œ â˜ â˜ â˜ â˜ â˜‘ â˜’ â˜“ â˜” â˜• â˜– â˜— â˜˜ â˜™ â˜š â˜› â˜œ â˜ â˜ â˜Ÿ'
            +'u2620: â˜  â˜¡ â˜¢ â˜£ â˜¤ â˜¥ â˜¦ â˜§ â˜¨ â˜© â˜ª â˜« â˜¬ â˜­ â˜® â˜¯ â˜° â˜± â˜² â˜³ â˜´ â˜µ â˜¶ â˜· â˜¸ â˜¹ â˜º â˜» â˜¼ â˜½ â˜¾ â˜¿'
            +'u2640: â™€ â™ â™‚ â™ƒ â™„ â™… â™† â™‡ â™ˆ â™‰ â™Š â™‹ â™Œ â™ â™ â™ â™ â™‘ â™’ â™“ â™” â™• â™– â™— â™˜ â™™ â™š â™› â™œ â™ â™ â™Ÿ'
            +'u2660: â™  â™¡ â™¢ â™£ â™¤ â™¥ â™¦ â™§ â™¨ â™© â™ª â™« â™¬ â™­ â™® â™¯ â™° â™± â™² â™³ â™´ â™µ â™¶ â™· â™¸ â™¹ â™º â™» â™¼ â™½ â™¾ â™¿'
            +'u2680: âš€ âš âš‚ âšƒ âš„ âš… âš† âš‡ âšˆ âš‰ âšŠ âš‹ âšŒ âš âš âš âš âš‘ âš’ âš“ âš” âš• âš– âš— âš˜ âš™ âšš âš› âšœ âš âš âšŸ'
            +'u26A0: âš  âš¡ âš¢ âš£ âš¤ âš¥ âš¦ âš§ âš¨ âš© âšª âš« âš¬ âš­ âš® âš¯ âš° âš± âš² âš³ âš´ âšµ âš¶ âš· âš¸ âš¹ âšº âš» âš¼ âš½ âš¾ âš¿'
            +'u2700: âœ€ âœ âœ‚ âœƒ âœ„ âœ… âœ† âœ‡ âœˆ âœ‰ âœŠ âœ‹ âœŒ âœ âœ âœ &#:000; âœ‘ âœ’ âœ“ âœ” âœ• âœ– âœ— âœ˜ âœ™ âœš âœ› âœœ âœ âœ âœŸ'
            +'u2720: âœ  âœ¡ âœ¢ âœ£ âœ¤ âœ¥ âœ¦ âœ§ âœ¨ âœ© âœª âœ« âœ¬ âœ­ âœ® âœ¯ âœ° âœ± âœ² âœ³ âœ´ âœµ âœ¶ âœ· âœ¸ âœ¹ âœº âœ» âœ¼ âœ½ âœ¾ âœ¿'
            +'u2740: â€ â â‚ âƒ â„ â… â† â‡ âˆ â‰ âŠ â‹ âŒ â â â â â‘ â’ â“ â” â• â– â— â˜ â™ âš â› âœ â â âŸ'
            +'u2760: â  â¡ â¢ â£ â¤ â¥ â¦ â§ â¨ â© âª â« â¬ â­ â® â¯ â° â± â² â³ â´ âµ â¶ â· â¸ â¹ âº â» â¼ â½ â¾ â¿'
            +'u2780: â€ â â‚ âƒ â„ â… â† â‡ âˆ â‰ âŠ â‹ âŒ â â â â â‘ â’ â“ â” â• â– â— â˜ â™ âš â› âœ â â âŸ'
            +'u27A0: â  â¡ â¢ â£ â¤ â¥ â¦ â§ â¨ â© âª â« â¬ â­ â® â¯ â° â± â² â³ â´ âµ â¶ â· â¸ â¹ âº â» â¼ â½ â¾ â¿'
            +'u27C0: âŸ€ âŸ âŸ‚ âŸƒ âŸ„ âŸ… âŸ† âŸ‡ âŸˆ âŸ‰ âŸŠ âŸ‹ âŸŒ âŸ âŸ âŸ âŸ âŸ‘ âŸ’ âŸ“ âŸ” âŸ• âŸ– âŸ— âŸ˜ âŸ™ âŸš âŸ› âŸœ âŸ âŸ âŸŸ'
            +'u27E0: âŸ  âŸ¡ âŸ¢ âŸ£ âŸ¤ âŸ¥ âŸ¦ âŸ§ âŸ¨ âŸ© âŸª âŸ« âŸ¬ âŸ­ âŸ® âŸ¯ âŸ° âŸ± âŸ² âŸ³ âŸ´ âŸµ âŸ¶ âŸ· âŸ¸ âŸ¹ âŸº âŸ» âŸ¼ âŸ½ âŸ¾ âŸ¿'
            +'u2800: â € â  â ‚ â ƒ â „ â … â † â ‡ â ˆ â ‰ â Š â ‹ â Œ â  â  â  â  â ‘ â ’ â “ â ” â • â – â — â ˜ â ™ â š â › â œ â  â  â Ÿ'
            +'u2820: â   â ¡ â ¢ â £ â ¤ â ¥ â ¦ â § â ¨ â © â ª â « â ¬ â ­ â ® â ¯ â ° â ± â ² â ³ â ´ â µ â ¶ â · â ¸ â ¹ â º â » â ¼ â ½ â ¾ â ¿'
            +'u2840: â¡€ â¡ â¡‚ â¡ƒ â¡„ â¡… â¡† â¡‡ â¡ˆ â¡‰ â¡Š â¡‹ â¡Œ â¡ â¡ â¡ â¡ â¡‘ â¡’ â¡“ â¡” â¡• â¡– â¡— â¡˜ â¡™ â¡š â¡› â¡œ â¡ â¡ â¡Ÿ'
            +'u2860: â¡  â¡¡ â¡¢ â¡£ â¡¤ â¡¥ â¡¦ â¡§ â¡¨ â¡© â¡ª â¡« â¡¬ â¡­ â¡® â¡¯ â¡° â¡± â¡² â¡³ â¡´ â¡µ â¡¶ â¡· â¡¸ â¡¹ â¡º â¡» â¡¼ â¡½ â¡¾ â¡¿'
            +'u2880: â¢€ â¢ â¢‚ â¢ƒ â¢„ â¢… â¢† â¢‡ â¢ˆ â¢‰ â¢Š â¢‹ â¢Œ â¢ â¢ â¢ â¢ â¢‘ â¢’ â¢“ â¢” â¢• â¢– â¢— â¢˜ â¢™ â¢š â¢› â¢œ â¢ â¢ â¢Ÿ'
            +'u28A0: â¢  â¢¡ â¢¢ â¢£ â¢¤ â¢¥ â¢¦ â¢§ â¢¨ â¢© â¢ª â¢« â¢¬ â¢­ â¢® â¢¯ â¢° â¢± â¢² â¢³ â¢´ â¢µ â¢¶ â¢· â¢¸ â¢¹ â¢º â¢» â¢¼ â¢½ â¢¾ â¢¿'
            +'u28C0: â£€ â£ â£‚ â£ƒ â£„ â£… â£† â£‡ â£ˆ â£‰ â£Š â£‹ â£Œ â£ â£ â£ â£ â£‘ â£’ â£“ â£” â£• â£– â£— â£˜ â£™ â£š â£› â£œ â£ â£ â£Ÿ'
            +'u28E0: â£  â£¡ â£¢ â££ â£¤ â£¥ â£¦ â£§ â£¨ â£© â£ª â£« â£¬ â£­ â£® â£¯ â£° â£± â£² â£³ â£´ â£µ â£¶ â£· â£¸ â£¹ â£º â£» â£¼ â£½ â£¾ â£¿'
            +'u2900: â¤€ â¤ â¤‚ â¤ƒ â¤„ â¤… â¤† â¤‡ â¤ˆ â¤‰ â¤Š â¤‹ â¤Œ â¤ â¤ â¤ â¤ â¤‘ â¤’ â¤“ â¤” â¤• â¤– â¤— â¤˜ â¤™ â¤š â¤› â¤œ â¤ â¤ â¤Ÿ'
            +'u2920: â¤  â¤¡ â¤¢ â¤£ â¤¤ â¤¥ â¤¦ â¤§ â¤¨ â¤© â¤ª â¤« â¤¬ â¤­ â¤® â¤¯ â¤° â¤± â¤² â¤³ â¤´ â¤µ â¤¶ â¤· â¤¸ â¤¹ â¤º â¤» â¤¼ â¤½ â¤¾ â¤¿'
            +'u2940: â¥€ â¥ â¥‚ â¥ƒ â¥„ â¥… â¥† â¥‡ â¥ˆ â¥‰ â¥Š â¥‹ â¥Œ â¥ â¥ â¥ â¥ â¥‘ â¥’ â¥“ â¥” â¥• â¥– â¥— â¥˜ â¥™ â¥š â¥› â¥œ â¥ â¥ â¥Ÿ'
            +'u2960: â¥  â¥¡ â¥¢ â¥£ â¥¤ â¥¥ â¥¦ â¥§ â¥¨ â¥© â¥ª â¥« â¥¬ â¥­ â¥® â¥¯ â¥° â¥± â¥² â¥³ â¥´ â¥µ â¥¶ â¥· â¥¸ â¥¹ â¥º â¥» â¥¼ â¥½ â¥¾ â¥¿'
            +'u2980: â¦€ â¦ â¦‚ â¦ƒ â¦„ â¦… â¦† â¦‡ â¦ˆ â¦‰ â¦Š â¦‹ â¦Œ â¦ â¦ â¦ â¦ â¦‘ â¦’ â¦“ â¦” â¦• â¦– â¦— â¦˜ â¦™ â¦š â¦› â¦œ â¦ â¦ â¦Ÿ'
            +'u29A0: â¦  â¦¡ â¦¢ â¦£ â¦¤ â¦¥ â¦¦ â¦§ â¦¨ â¦© â¦ª â¦« â¦¬ â¦­ â¦® â¦¯ â¦° â¦± â¦² â¦³ â¦´ â¦µ â¦¶ â¦· â¦¸ â¦¹ â¦º â¦» â¦¼ â¦½ â¦¾ â¦¿'
            +'u29C0: â§€ â§ â§‚ â§ƒ â§„ â§… â§† â§‡ â§ˆ â§‰ â§Š â§‹ â§Œ â§ â§ â§ â§ â§‘ â§’ â§“ â§” â§• â§– â§— â§˜ â§™ â§š â§› â§œ â§ â§ â§Ÿ'
            +'u29E0: â§  â§¡ â§¢ â§£ â§¤ â§¥ â§¦ â§§ â§¨ â§© â§ª â§« â§¬ â§­ â§® â§¯ â§° â§± â§² â§³ â§´ â§µ â§¶ â§· â§¸ â§¹ â§º â§» â§¼ â§½ â§¾ â§¿'
            +'u2A00: â¨€ â¨ â¨‚ â¨ƒ â¨„ â¨… â¨† â¨‡ â¨ˆ â¨‰ â¨Š â¨‹ â¨Œ â¨ â¨ â¨ â¨ â¨‘ â¨’ â¨“ â¨” â¨• â¨– â¨— â¨˜ â¨™ â¨š â¨› â¨œ â¨ â¨ â¨Ÿ'
            +'u2A20: â¨  â¨¡ â¨¢ â¨£ â¨¤ â¨¥ â¨¦ â¨§ â¨¨ â¨© â¨ª â¨« â¨¬ â¨­ â¨® â¨¯ â¨° â¨± â¨² â¨³ â¨´ â¨µ â¨¶ â¨· â¨¸ â¨¹ â¨º â¨» â¨¼ â¨½ â¨¾ â¨¿'
            +'u2A40: â©€ â© â©‚ â©ƒ â©„ â©… â©† â©‡ â©ˆ â©‰ â©Š â©‹ â©Œ â© â© â© â© â©‘ â©’ â©“ â©” â©• â©– â©— â©˜ â©™ â©š â©› â©œ â© â© â©Ÿ'
            +'u2A60: â©  â©¡ â©¢ â©£ â©¤ â©¥ â©¦ â©§ â©¨ â©© â©ª â©« â©¬ â©­ â©® â©¯ â©° â©± â©² â©³ â©´ â©µ â©¶ â©· â©¸ â©¹ â©º â©» â©¼ â©½ â©¾ â©¿'
            +'u2A80: âª€ âª âª‚ âªƒ âª„ âª… âª† âª‡ âªˆ âª‰ âªŠ âª‹ âªŒ âª âª âª âª âª‘ âª’ âª“ âª” âª• âª– âª— âª˜ âª™ âªš âª› âªœ âª âª âªŸ'
            +'u2AA0: âª  âª¡ âª¢ âª£ âª¤ âª¥ âª¦ âª§ âª¨ âª© âªª âª« âª¬ âª­ âª® âª¯ âª° âª± âª² âª³ âª´ âªµ âª¶ âª· âª¸ âª¹ âªº âª» âª¼ âª½ âª¾ âª¿';
        legacynote.body=body;
        legacynote.parentId=c.Id; 
        legacynote.OwnerId = UserInfo.getUserId();
        legacynote.CreatedDate = Date.today();
        
        insert legacynote;
        
        List<String> resultAux = new List<String>();
        //get the ids
        resultAux.add(legacynote.Id);        
        Test.startTest();
        //run the migration by Ids  
        NMTMigratorBatch batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today(), true);
        Id batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
   
        Test.stopTest();
        
        List<NAMNoteConverted__C> contentVersions = [SELECT Id FROM NAMNoteConverted__C WHERE LegacyNoteConvertedId__c in :resultAux];
        //assert 1 contentVersion was created
        System.assertEquals(1, contentVersions.size(), '1 Content Note created');
        
        List<ContentDocumentLink> cdls = [SELECT Id FROM ContentDocumentLink WHERE
                                          linkedEntityId = :c.Id
                                          AND
                                          contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c in :resultAux];
        //assert 1 CDL was created
        System.assertEquals(1, cdls.size(), '1 Content Note linked to the parent Contact');
        }
    }
    
           /**
* @description tests notes migration with invalid characters
* Test Case Name: Migrate note that has special characters
*/    
   
    @isTest
    static void testNotestMigrationInvalidCharacters3(){
        if(NAMUtils.isEnhancedNotesEnabled()||NAMUtils.ENABLE_NOTES_TESTS){
        Contact c = NMTTestNoteUtils.createContact();
        //create a legacy note
        Note legacynote = new Note();
        legacynote.Title='noteTitle';
        String body = 'u2AC0: â«€ â« â«‚ â«ƒ â«„ â«… â«† â«‡ â«ˆ â«‰ â«Š â«‹ â«Œ â« â« â« â« â«‘ â«’ â«“ â«” â«• â«– â«— â«˜ â«™ â«š â«› â«Ì¸ â« â« â«Ÿ'
            +'u2AE0: â«  â«¡ â«¢ â«£ â«¤ â«¥ â«¦ â«§ â«¨ â«© â«ª â«« â«¬ â«­ â«® â«¯ â«° â«± â«² â«³ â«´ â«µ â«¶ â«· â«¸ â«¹ â«º â«» â«¼ â«½ â«¾ â«¿'
            +'u2B00: â¬€ â¬ â¬‚ â¬ƒ â¬„ â¬… â¬† â¬‡ â¬ˆ â¬‰ â¬Š â¬‹ â¬Œ â¬ â¬ â¬ â¬ â¬‘ â¬’ â¬“ â¬” â¬• â¬– â¬— â¬˜ â¬™ â¬š â¬› â¬œ â¬ â¬ â¬Ÿ'
            +'u2B20: â¬  â¬¡ â¬¢ â¬£ â¬¤ â¬¥ â¬¦ â¬§ â¬¨ â¬© â¬ª â¬« â¬¬ â¬­ â¬® â¬¯ â¬° â¬± â¬² â¬³ â¬´ â¬µ â¬¶ â¬· â¬¸ â¬¹ â¬º â¬» â¬¼ â¬½ â¬¾ â¬¿'
            +'u2C60: â±  â±¡ â±¢ â±£ â±¤ â±¥ â±¦ â±§ â±¨ â±© â±ª â±« â±¬ â±­ â±® â±¯ â±° â±± â±² â±³ â±´ â±µ â±¶ â±· â±¸ â±¹ â±º â±» â±¼ â±½ â±¾ â±¿'
            +'u2E80: âº€ âº âº‚ âºƒ âº„ âº… âº† âº‡ âºˆ âº‰ âºŠ âº‹ âºŒ âº âº âº âº âº‘ âº’ âº“ âº” âº• âº– âº— âº˜ âº™ âºš âº› âºœ âº âº âºŸ'
            +'u2EA0: âº  âº¡ âº¢ âº£ âº¤ âº¥ âº¦ âº§ âº¨ âº© âºª âº« âº¬ âº­ âº® âº¯ âº° âº± âº² âº³ âº´ âºµ âº¶ âº· âº¸ âº¹ âºº âº» âº¼ âº½ âº¾ âº¿'
            +'u2EC0: â»€ â» â»‚ â»ƒ â»„ â»… â»† â»‡ â»ˆ â»‰ â»Š â»‹ â»Œ â» â» â» â» â»‘ â»’ â»“ â»” â»• â»– â»— â»˜ â»™ â»š â»› â»œ â» â» â»Ÿ'
            +'u2EE0: â»  â»¡ â»¢ â»£ â»¤ â»¥ â»¦ â»§ â»¨ â»© â»ª â»« â»¬ â»­ â»® â»¯ â»° â»± â»² â»³ â»´ â»µ â»¶ â»· â»¸ â»¹ â»º â»» â»¼ â»½ â»¾ â»¿'
            +'u2F00: â¼€ â¼ â¼‚ â¼ƒ â¼„ â¼… â¼† â¼‡ â¼ˆ â¼‰ â¼Š â¼‹ â¼Œ â¼ â¼ â¼ â¼ â¼‘ â¼’ â¼“ â¼” â¼• â¼– â¼— â¼˜ â¼™ â¼š â¼› â¼œ â¼ â¼ â¼Ÿ'
            +'u2F20: â¼  â¼¡ â¼¢ â¼£ â¼¤ â¼¥ â¼¦ â¼§ â¼¨ â¼© â¼ª â¼« â¼¬ â¼­ â¼® â¼¯ â¼° â¼± â¼² â¼³ â¼´ â¼µ â¼¶ â¼· â¼¸ â¼¹ â¼º â¼» â¼¼ â¼½ â¼¾ â¼¿'
            +'u2F40: â½€ â½ â½‚ â½ƒ â½„ â½… â½† â½‡ â½ˆ â½‰ â½Š â½‹ â½Œ â½ â½ â½ â½ â½‘ â½’ â½“ â½” â½• â½– â½— â½˜ â½™ â½š â½› â½œ â½ â½ â½Ÿ'
            +'u3040: ã€ ã ã‚ ãƒ ã„ ã… ã† ã‡ ãˆ ã‰ ãŠ ã‹ ãŒ ã ã ã ã ã‘ ã’ ã“ ã” ã• ã– ã— ã˜ ã™ ãš ã› ãœ ã ã ãŸ'
            +'u3060: ã  ã¡ ã¢ ã£ ã¤ ã¥ ã¦ ã§ ã¨ ã© ãª ã« ã¬ ã­ ã® ã¯ ã° ã± ã² ã³ ã´ ãµ ã¶ ã· ã¸ ã¹ ãº ã» ã¼ ã½ ã¾ ã¿'
            +'u3360: ã  ã¡ ã¢ ã£ ã¤ ã¥ ã¦ ã§ ã¨ ã© ãª ã« ã¬ ã­ ã® ã¯ ã° ã± ã² ã³ ã´ ãµ ã¶ ã· ã¸ ã¹ ãº ã» ã¼ ã½ ã¾ ã¿'
            +'u3380: ã€ ã ã‚ ãƒ ã„ ã… ã† ã‡ ãˆ ã‰ ãŠ ã‹ ãŒ ã ã ã ã ã‘ ã’ ã“ ã” ã• ã– ã— ã˜ ã™ ãš ã› ãœ ã ã ãŸ'
            +'u33A0: ã  ã¡ ã¢ ã£ ã¤ ã¥ ã¦ ã§ ã¨ ã© ãª ã« ã¬ ã­ ã® ã¯ ã° ã± ã² ã³ ã´ ãµ ã¶ ã· ã¸ ã¹ ãº ã» ã¼ ã½ ã¾ ã¿'
            +'u33C0: ã€ ã ã‚ ãƒ ã„ ã… ã† ã‡ ãˆ ã‰ ãŠ ã‹ ãŒ ã ã ã ã ã‘ ã’ ã“ ã” ã• ã– ã— ã˜ ã™ ãš ã› ãœ ã ã ãŸ'
            +'u50C0: åƒ€ åƒ åƒ‚ åƒƒ åƒ„ åƒ… åƒ† åƒ‡ åƒˆ åƒ‰ åƒŠ åƒ‹ åƒŒ åƒ åƒ åƒ åƒ åƒ‘ åƒ’ åƒ“ åƒ” åƒ• åƒ– åƒ— åƒ˜ åƒ™ åƒš åƒ› åƒœ åƒ åƒ åƒŸ'
            +'u50E0: åƒ  åƒ¡ åƒ¢ åƒ£ åƒ¤ åƒ¥ åƒ¦ åƒ§ åƒ¨ åƒ© åƒª åƒ« åƒ¬ åƒ­ åƒ® åƒ¯ åƒ° åƒ± åƒ² åƒ³ åƒ´ åƒµ åƒ¶ åƒ· åƒ¸ åƒ¹ åƒº åƒ» åƒ¼ åƒ½ åƒ¾ åƒ¿'
            +'uA9E0: ê§  ê§¡ ê§¢ ê§£ ê§¤ ê§¥ ê§¦ ê§§ ê§¨ ê§© ê§ª ê§« ê§¬ ê§­ ê§® ê§¯ ê§° ê§± ê§² ê§³ ê§´ ê§µ ê§¶ ê§· ê§¸ ê§¹ ê§º ê§» ê§¼ ê§½ ê§¾ ê§¿'
            +'uAC00: ê°€ ê° ê°‚ ê°ƒ ê°„ ê°… ê°† ê°‡ ê°ˆ ê°‰ ê°Š ê°‹ ê°Œ ê° ê° ê° ê° ê°‘ ê°’ ê°“ ê°” ê°• ê°– ê°— ê°˜ ê°™ ê°š ê°› ê°œ ê° ê° ê°Ÿ'
            +'uAC20: ê°  ê°¡ ê°¢ ê°£ ê°¤ ê°¥ ê°¦ ê°§ ê°¨ ê°© ê°ª ê°« ê°¬ ê°­ ê°® ê°¯ ê°° ê°± ê°² ê°³ ê°´ ê°µ ê°¶ ê°· ê°¸ ê°¹ ê°º ê°» ê°¼ ê°½ ê°¾ ê°¿'
            +'uE220: îˆ  îˆ¡ îˆ¢ îˆ£ îˆ¤ îˆ¥ îˆ¦ îˆ§ îˆ¨ îˆ© îˆª îˆ« îˆ¬ îˆ­ îˆ® îˆ¯ îˆ° îˆ± îˆ² îˆ³ îˆ´ îˆµ îˆ¶ îˆ· îˆ¸ îˆ¹ îˆº îˆ» îˆ¼ îˆ½ îˆ¾ îˆ¿'
            +'uE240: î‰€ î‰ î‰‚ î‰ƒ î‰„ î‰… î‰† î‰‡ î‰ˆ î‰‰ î‰Š î‰‹ î‰Œ î‰ î‰ î‰ î‰ î‰‘ î‰’ î‰“ î‰” î‰• î‰– î‰— î‰˜ î‰™ î‰š î‰› î‰œ î‰ î‰ î‰Ÿ'
            +'uEA00: î¨€ î¨ î¨‚ î¨ƒ î¨„ î¨… î¨† î¨‡ î¨ˆ î¨‰ î¨Š î¨‹ î¨Œ î¨ î¨ î¨ î¨ î¨‘ î¨’ î¨“ î¨” î¨• î¨– î¨— î¨˜ î¨™ î¨š î¨› î¨œ î¨ î¨ î¨Ÿ';
        legacynote.body=body;
        legacynote.parentId=c.Id; 
        legacynote.OwnerId = UserInfo.getUserId();
        legacynote.CreatedDate = Date.today();
        
        insert legacynote;
        
        List<String> resultAux = new List<String>();
        //get the ids
        resultAux.add(legacynote.Id);        
        Test.startTest();
        //run the migration by Ids  
        NMTMigratorBatch batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today(), true);
        Id batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
   
        Test.stopTest();
        
        List<NAMNoteConverted__C> contentVersions = [SELECT Id FROM NAMNoteConverted__C WHERE LegacyNoteConvertedId__c in :resultAux];
        //assert 1 contentVersion was created
        System.assertEquals(1, contentVersions.size(), '1 Content Note created');
        
        List<ContentDocumentLink> cdls = [SELECT Id FROM ContentDocumentLink WHERE
                                          linkedEntityId = :c.Id
                                          AND
                                          contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c in :resultAux];
        //assert 1 CDL was created
        System.assertEquals(1, cdls.size(), '1 Content Note linked to the parent Contact');
        }
    }
    
        /**
* @description tests notes migration with invalid characters
* Test Case Name: Migrate note that has special characters
*/    
   
    @isTest
    static void testNotestMigrationInvalidCharacters4(){
        if(NAMUtils.isEnhancedNotesEnabled()||NAMUtils.ENABLE_NOTES_TESTS){
        Contact c = NMTTestNoteUtils.createContact();
        //create a legacy note
        Note legacynote = new Note();
        legacynote.Title='noteTitle';
        String body = 'uEA20: î¨  î¨¡ î¨¢ î¨£ î¨¤ î¨¥ î¨¦ î¨§ î¨¨ î¨© î¨ª î¨« î¨¬ î¨­ î¨® î¨¯ î¨° î¨± î¨² î¨³ î¨´ î¨µ î¨¶ î¨· î¨¸ î¨¹ î¨º î¨» î¨¼ î¨½ î¨¾ î¨¿'
            +'uEDA0: î¶  î¶¡ î¶¢ î¶£ î¶¤ î¶¥ î¶¦ î¶§ î¶¨ î¶© î¶ª î¶« î¶¬ î¶­ î¶® î¶¯ î¶° î¶± î¶² î¶³ î¶´ î¶µ î¶¶ î¶· î¶¸ î¶¹ î¶º î¶» î¶¼ î¶½ î¶¾ î¶¿'
            +'uEE20: î¸  î¸¡ î¸¢ î¸£ î¸¤ î¸¥ î¸¦ î¸§ î¸¨ î¸© î¸ª î¸« î¸¬ î¸­ î¸® î¸¯ î¸° î¸± î¸² î¸³ î¸´ î¸µ î¸¶ î¸· î¸¸ î¸¹ î¸º î¸» î¸¼ î¸½ î¸¾ î¸¿'
            +'uEE60: î¹  î¹¡ î¹¢ î¹£ î¹¤ î¹¥ î¹¦ î¹§ î¹¨ î¹© î¹ª î¹« î¹¬ î¹­ î¹® î¹¯ î¹° î¹± î¹² î¹³ î¹´ î¹µ î¹¶ î¹· î¹¸ î¹¹ î¹º î¹» î¹¼ î¹½ î¹¾ î¹¿'
            +'uFB00: ï¬€ ï¬ ï¬‚ ï¬ƒ ï¬„ ï¬… ï¬† ï¬‡ ï¬ˆ ï¬‰ ï¬Š ï¬‹ ï¬Œ ï¬ ï¬ ï¬ ï¬ ï¬‘ ï¬’ ï¬“ ï¬” ï¬• ï¬– ï¬— ï¬˜ ï¬™ ï¬š ï¬› ï¬œ ×™Ö´ ï¬ ×²Ö·'
            +'uFB20: ï¬  ï¬¡ ï¬¢ ï¬£ ï¬¤ ï¬¥ ï¬¦ ï¬§ ï¬¨ ï¬© ×©× ×©×‚ ×©Ö¼× ×©Ö¼×‚ ×Ö· ×Ö¸ ×Ö¼ ×‘Ö¼ ×’Ö¼ ×“Ö¼ ×”Ö¼ ×•Ö¼ ×–Ö¼ ï¬· ×˜Ö¼ ×™Ö¼ ×šÖ¼ ×›Ö¼ ×œÖ¼ ï¬½ ×Ö¼ ï¬¿'
            +'uFFE0: ï¿  ï¿¡ ï¿¢ ï¿£ ï¿¤ ï¿¥ ï¿¦ ï¿§ ï¿¨ ï¿© ï¿ª ï¿« ï¿¬ ï¿­ ï¿® ï¿¯ ï¿° ï¿± ï¿² ï¿³ ï¿´ ï¿µ ï¿¶ ï¿· ï¿¸   ï¿» ï¿¼ ï¿½  '
            +'ğŸ˜€ ğŸ˜ ğŸ˜‚ ğŸ¤£ ğŸ˜ƒ ğŸ˜„ ğŸ˜… ğŸ˜† ğŸ˜‰ ğŸ˜Š ğŸ˜‹ ğŸ˜ ğŸ˜ ğŸ˜˜ ğŸ˜— ğŸ˜™ ğŸ˜š â˜ºï¸ ğŸ™‚ ğŸ¤— '
           +'ğŸ¤”  ğŸ˜ ğŸ˜‘ ğŸ˜¶ ğŸ™„ ğŸ˜ ğŸ˜£ ğŸ˜¥ ğŸ˜® ğŸ¤ ğŸ˜¯ ğŸ˜ª ğŸ˜« ğŸ˜´ ğŸ˜Œ ğŸ˜› ğŸ˜œ ğŸ˜ ğŸ¤¤ ğŸ˜’ ğŸ˜“ ğŸ˜” ğŸ˜• ğŸ™ƒ ğŸ¤‘ ' 
           +'ğŸ˜² â˜¹ï¸ ğŸ™ ğŸ˜– ğŸ˜ ğŸ˜Ÿ ğŸ˜¤ ğŸ˜¢ ğŸ˜­ ğŸ˜¦ ğŸ˜§ ğŸ˜¨ ğŸ˜©ğŸ˜¬ ğŸ˜° ğŸ˜± ğŸ˜³  ğŸ˜µ ğŸ˜¡ ğŸ˜ ğŸ˜· ğŸ¤’ ğŸ¤• ğŸ¤¢ğŸ¤§ ' 
            +'ğŸ˜‡ ğŸ¤  ğŸ¤¡ ğŸ¤¥ ğŸ¤“ ğŸ˜ˆ ğŸ‘¿ ğŸ‘¹ ğŸ‘º ğŸ’€ ğŸ‘» ğŸ‘½ ğŸ¤– ğŸ’© ğŸ˜º ğŸ˜¸ ğŸ˜¹ ğŸ˜» ğŸ˜¼ ğŸ˜½ ğŸ™€ ğŸ˜¿ ğŸ˜¾';
        legacynote.body=body;
        legacynote.parentId=c.Id; 
        legacynote.OwnerId = UserInfo.getUserId();
        legacynote.CreatedDate = Date.today();
        
        insert legacynote;
        
        List<String> resultAux = new List<String>();
        //get the ids
        resultAux.add(legacynote.Id);        
        Test.startTest();
        //run the migration by Ids  
        NMTMigratorBatch batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today(), true);
        Id batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
   
        Test.stopTest();
        
        List<NAMNoteConverted__C> contentVersions = [SELECT Id FROM NAMNoteConverted__C WHERE LegacyNoteConvertedId__c in :resultAux];
        //assert 1 contentVersion was created
        System.assertEquals(1, contentVersions.size(), '1 Content Note created');
        
        List<ContentDocumentLink> cdls = [SELECT Id FROM ContentDocumentLink WHERE
                                          linkedEntityId = :c.Id
                                          AND
                                          contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c in :resultAux];
        //assert 1 CDL was created
        System.assertEquals(1, cdls.size(), '1 Content Note linked to the parent Contact');
        }
    }


    /**
* @description tests notes migration with empty body
* Test Case Name: Migrate note with empty body
*/
    @isTest
    static void testNotestMigrationEmptyBody(){
        if(NAMUtils.isEnhancedNotesEnabled()||NAMUtils.ENABLE_NOTES_TESTS){
        /*
* Steps:
* - create a contact 
* - create a legacy note with empty body
* - get the id
* - run the migration by Id
* - assert 1 contentVersion is created
* - assert 1 CDL is created
*/
        
        Contact c = NMTTestNoteUtils.createContact();
        //create a legacy note
        Note legacynote = new Note();
        legacynote.Title='noteTitle';
        String body = '';
        
        legacynote.body=body;
        legacynote.parentId=c.Id; 
        legacynote.IsPrivate = false;
        legacynote.OwnerId = UserInfo.getUserId();
        legacynote.CreatedDate = Date.today();
        
        insert legacynote;
        
        List<String> resultAux = new List<String>();
        //get the ids
        resultAux.add(legacynote.Id);
        
        
        Test.startTest();
        //run the migration by Ids  
        NMTMigratorBatch batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today(), true);
        Id batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
        Test.stopTest();
        
        List<NAMNoteConverted__C> contentVersions = [SELECT Id FROM NAMNoteConverted__C WHERE LegacyNoteConvertedId__c in :resultAux];
        //assert 1 contentVersion was created
        System.assertEquals(1, contentVersions.size(), '1 Content Note created');
        
        List<ContentDocumentLink> cdls = [SELECT Id FROM ContentDocumentLink WHERE
                                          linkedEntityId = :c.Id
                                          AND
                                          contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c in :resultAux];
        //assert 1 CDL was created
        System.assertEquals(1, cdls.size(), '1 Content Note linked to the parent Contact');
        }
    }
    
    /**
* @description tests notes migration with all characters body
* Test Case Name: Migrate note with all characters body
*/
    @isTest
    static void testNotestMigrationAllCharactersBody(){
        if(NAMUtils.isEnhancedNotesEnabled()||NAMUtils.ENABLE_NOTES_TESTS){
        /*
* Steps:
* - create a contact 
* - create a legacy note with all characters body
* - get the id
* - run the migration by Id
* - assert 1 contentVersion is created
* - assert 1 CDL is created
*/
        
        StaticResource allCharacters = [Select body, name from StaticResource where Name = 'NMTcharacters' LIMIT 1];
        String bodys = EncodingUtil.base64Encode(allCharacters.Body);
        Integer quantity = bodys.length()/32000;
        
        Contact c = NMTTestNoteUtils.createContact();
        List<String> resultAux = new List<String>();
        for(integer i = 0; i<quantity; i++){
            //create a legacy note
            Note legacynote = new Note();
            legacynote.Title='noteTitle';
            String body = bodys.substring(i*32000, i*32000+32000);
            
            legacynote.body=body;
            legacynote.parentId=c.Id; 
            legacynote.IsPrivate = false;
            legacynote.OwnerId = UserInfo.getUserId();
            legacynote.CreatedDate = Date.today();
            
            insert legacynote;
            //get the ids
            resultAux.add(legacynote.Id);
        }
        
        Test.startTest();
        //run the migration by Ids  
        NMTMigratorBatch batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today(), true);
        Id batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
        Test.stopTest();
        
        List<NAMNoteConverted__C> contentVersions = [SELECT Id FROM NAMNoteConverted__C WHERE LegacyNoteConvertedId__c in :resultAux];
        //assert contentVersions were created
        System.assertEquals(quantity, contentVersions.size(), '1 Content Note created');
        
        List<ContentDocumentLink> cdls = [SELECT Id FROM ContentDocumentLink WHERE
                                          linkedEntityId = :c.Id
                                          AND
                                          contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c in :resultAux];
        //assert CDLs were created
        System.assertEquals(quantity, cdls.size(), '1 Content Note linked to the parent Contact');
        }
    }
    
    /**
* @description tests notes migration with the longest body
* Test Case Name: Migrate note with the longest body possible
*/
    @isTest
    static void testNotestMigrationLongestBody(){
        if(NAMUtils.isEnhancedNotesEnabled()||NAMUtils.ENABLE_NOTES_TESTS){
        /*
* Steps:
* - create a contact 
* - create a legacy note with empty body
* - get the id
* - run the migration by Id
* - assert 1 contentVersion is created
* - assert 1 CDL is created
*/
        
        Contact c = NMTTestNoteUtils.createContact();
        //create a legacy note
        Note legacynote = new Note();
        legacynote.Title='noteTitle';
        String body = '';
        
        for(integer i=0; i<32000; i++){
            body+='a';
        }
        
        legacynote.body=body;
        legacynote.parentId=c.Id; 
        legacynote.IsPrivate = false;
        legacynote.OwnerId = UserInfo.getUserId();
        legacynote.CreatedDate = Date.today();
        
        insert legacynote;
        
        List<String> resultAux = new List<String>();
        //get the ids
        resultAux.add(legacynote.Id);
        
        
        Test.startTest();
        //run the migration by Ids  
        NMTMigratorBatch batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today(), true);
        Id batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
        Test.stopTest();
        
        List<NAMNoteConverted__C> contentVersions = [SELECT Id FROM NAMNoteConverted__C WHERE LegacyNoteConvertedId__c in :resultAux];
        //assert 1 contentVersion was created
        System.assertEquals(1, contentVersions.size(), '1 Content Note created');
        
        List<ContentDocumentLink> cdls = [SELECT Id FROM ContentDocumentLink WHERE
                                          linkedEntityId = :c.Id
                                          AND
                                          contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c in :resultAux];
        //assert 1 CDL was created
        System.assertEquals(1, cdls.size(), '1 Content Note linked to the parent Contact');
        }
    }
    
    
    /**
* @description tests notes migration with html in body
*/
    @isTest
    static void testNotestMigrationHtmlBody(){
if(NAMUtils.isEnhancedNotesEnabled()||NAMUtils.ENABLE_NOTES_TESTS){        
        /*
* Steps:
* - create a contact 
* - create a legacy note with html in body
* - get the id
* - run the migration by Id
* - assert 1 contentVersion is created
* - assert 1 CDL is created
*/
        
        Contact c = NMTTestNoteUtils.createContact();
        //create a legacy note
        Note legacynote = new Note();
        legacynote.Title='noteTitle';
        String body = '<p><em>algo</em></p>';
        
        legacynote.body=body;
        legacynote.parentId=c.Id; 
        legacynote.IsPrivate = false;
        legacynote.OwnerId = UserInfo.getUserId();
        legacynote.CreatedDate = Date.today();
        
        insert legacynote;
        
        List<String> resultAux = new List<String>();
        //get the ids
        resultAux.add(legacynote.Id);
        
        
        Test.startTest();
        //run the migration by Ids  
        NMTMigratorBatch batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today(), true);
        Id batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
        Test.stopTest();
        
        List<NAMNoteConverted__C> contentVersions = [SELECT Id FROM NAMNoteConverted__C WHERE LegacyNoteConvertedId__c in :resultAux];
        //assert 1 contentVersion was created
        System.assertEquals(1, contentVersions.size(), '1 Content Note created');
        
        List<ContentDocumentLink> cdls = [SELECT Id FROM ContentDocumentLink WHERE
                                          linkedEntityId = :c.Id
                                          AND
                                          contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c in :resultAux];
        //assert 1 CDL was created
        System.assertEquals(1, cdls.size(), '1 Content Note linked to the parent Contact');
}
    }
    
    /**
* @description tests notes migration by Ids for Standard User
* Test Case Name: Migrate one object with legacy notes from standard user
*/
    @isTest
    static void testNotestMigrationByIdFromStandardUser(){
        if(NAMUtils.isEnhancedNotesEnabled()||NAMUtils.ENABLE_NOTES_TESTS){
        /*
* Steps:
* - create a contact from a standard user
* - create two legacy note from a standard user
* - get the ids
* - run the migration by Ids
* - assert 2 contentVersions were created
* - assert 2 CDLs were created
*/
        
        //create two legacy note from a standard user
        
        // Setup test data
        // This code runs as the system user
        Profile p = [SELECT Id FROM Profile WHERE Name='Standard User'];
        User u = new User(Alias = 'standt', Email='standarduser@testorg.com',
                          EmailEncodingKey='UTF-8', LastName='Testing', LanguageLocaleKey='en_US',
                          LocaleSidKey='en_US', ProfileId = p.Id,
                          TimeZoneSidKey='America/Los_Angeles', UserName='standarduser@notes.attachments.testorg.com');
        
        System.runAs(u) {
            // The following code runs as user 'u'
            Contact contact1 = NMTTestNoteUtils.createContact();
            Boolean privateNotes = false;
            String noteTitle = 'random note title '+NMTTestNoteUtils.randomInteger();
            NMTTestNoteUtils.createNoteForObject(2, contact1.Id, privateNotes, noteTitle);
        }
        
        // This code runs as the system user
        Contact c = [SELECT Id FROM Contact LIMIT 1];
        List<Note> notes = [SELECT Id, Title, Body, Parent.Type, OwnerId, LastModifiedDate, CreatedDate, CreatedById, LastModifiedById FROM Note];
        //Assert that a note was created
        System.assertEquals(2, notes.size());
        
        List<String> resultAux = new List<String>();
        //get the ids
        for(Note note:notes)
        {
            resultAux.add(note.Id);
        }
        
        //assert that 2 Legacy Notes were created
        System.assertEquals(2, resultAux.size(), '2 Legacy Notes created to migrate');
        
        Test.startTest();
        //run the migration by Ids  
        NMTMigratorBatch batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today(), true);
        Id batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
        Test.stopTest();
        
        
        
        List<ContentDocumentLink> cdls = [SELECT Id FROM ContentDocumentLink WHERE
                                          linkedEntityId = :c.Id
                                          AND
                                          contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c in :resultAux];
        //assert 2 CDLs were created
        System.assertEquals(2, cdls.size(), '2 Content Notes linked to the parent Contact');
        }
    }
    
    /**
* @description tests notes migration by Ids for Standard User
* Test Case Name: Migrate inactive user notes
*/
    @isTest
    static void testNotestMigrationByIdFromInactiveUser(){
        if(NAMUtils.isEnhancedNotesEnabled()||NAMUtils.ENABLE_NOTES_TESTS){
        /*
* Steps:
* - create a contact from a standard user
* - create two legacy note from a standard user
* - get the ids
* - make the user inactive
* - run the migration by Ids
* - assert 2 contentVersions were created
* - assert 2 CDLs were created
*/
        
        //create two legacy note from a standard user
        
        // Setup test data
        // This code runs as the system user
        Profile p = [SELECT Id FROM Profile WHERE Name='Standard User'];
        User u = new User(Alias = 'standt', Email='standarduser@testorg.com',
                          EmailEncodingKey='UTF-8', LastName='Testing', LanguageLocaleKey='en_US',
                          LocaleSidKey='en_US', ProfileId = p.Id,
                          TimeZoneSidKey='America/Los_Angeles', UserName='standarduser@notes.attachments.testorg.com');
        
        System.runAs(u) {
            // The following code runs as user 'u'
            Contact contact1 = NMTTestNoteUtils.createContact();
            Boolean privateNotes = false;
            String noteTitle = 'random note title '+NMTTestNoteUtils.randomInteger();
            NMTTestNoteUtils.createNoteForObject(2, contact1.Id, privateNotes, noteTitle);
        }
        
        //make the user inactive
        u.IsActive = false;
        
        // This code runs as the system user
        Contact c = [SELECT Id FROM Contact LIMIT 1];
        List<Note> notes = [SELECT Id, Title, Body, Parent.Type, OwnerId, LastModifiedDate, CreatedDate, CreatedById, LastModifiedById FROM Note];
        //Assert that a note was created
        System.assertEquals(2, notes.size());
        
        List<String> resultAux = new List<String>();
        //get the ids
        for(Note note:notes)
        {
            resultAux.add(note.Id);
        }
        
        //assert that 2 Legacy Notes were created
        System.assertEquals(2, resultAux.size(), '2 Legacy Notes created to migrate');
        
        Test.startTest();
        //run the migration by Ids  
        NMTMigratorBatch batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today(), true);
        Id batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
        Test.stopTest();
        
        
        
        List<ContentDocumentLink> cdls = [SELECT Id FROM ContentDocumentLink WHERE
                                          linkedEntityId = :c.Id
                                          AND
                                          contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c in :resultAux];
        //assert 2 CDLs were created
        System.assertEquals(2, cdls.size(), '2 Content Notes linked to the parent Contact');
        }
    }
    
    /*
@isTest
static void testNotestMigrationByObjectIdPublicPrivate(){

/*
* Steps:
* - create a Contact
* - create two legacy notes (one private and one public)
* - get the id of the contact
* - run the migration by Objects Ids
* - assert one CDLs was created


Contact c = NMTTestNoteUtils.createContact();
//create a private legacy notes for the Contact
NMTTestNoteUtils.createNoteForObject(1, c.Id, true);
//create a public legacy notes for the Contact
NMTTestNoteUtils.createNoteForObject(1, c.Id, false);

List<String> resultAux = new List<String>();
//get the ids
resultAux.add(c.Id);


//assert that 1 Object was created
System.assertEquals(1, resultAux.size(), '1 Objects created to migrate their notes');

Test.startTest();
//run the migration by Ids  
NMTMigratorBatch batch = new NMTMigratorBatch(null, resultAux, 'byObjectId', null, System.today(), System.today());
Id batchId = Database.executeBatch(batch, 100);
NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
Test.stopTest();


List<ContentDocumentLink> cdls = [SELECT Id FROM ContentDocumentLink WHERE
linkedEntityId in :resultAux
AND
contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c != null];
//assert no CDLs were created
System.assertEquals(1, cdls.size());
}

*/
    /**
* @description tests notes migration by Ids private
* Test Case Name: Migrate by note id from standard note that it's private
*/
    /*
@isTest
static void testNotestMigrationByIdPrivate(){

/*
* Steps:
* - create a contact 
* - create two legacy notes private
* - get the ids
* - run the migration by Ids
* - assert 0 CDLs were created


Contact c = NMTTestNoteUtils.createContact();
//create two legacy note
List<Note> notes = NMTTestNoteUtils.createNoteForObject(2, c.Id, true);
List<String> resultAux = new List<String>();
//get the ids
for(Note note:notes)
{
resultAux.add(note.Id);
}

//assert that 2 Legacy Notes were created
System.assertEquals(2, resultAux.size(), '2 Legacy Notes created to migrate');

Test.startTest();
//run the migration by Ids  
NMTMigratorBatch batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today());
Id batchId = Database.executeBatch(batch, 100);
NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
Test.stopTest();

List<ContentDocumentLink> cdls = [SELECT Id FROM ContentDocumentLink WHERE
linkedEntityId = :c.Id
AND
contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c in :resultAux];
//assert no CDLs were created
System.assert(cdls.isEmpty());
}
*/
    
    
    
    /**
* @description tests notes migration by Ids that not exists
* Test Case Name: Migrate by id that not exist
*/
    @isTest
    static void testNotestMigrationByIdNotExists(){
        if(NAMUtils.isEnhancedNotesEnabled()||NAMUtils.ENABLE_NOTES_TESTS){
        /*
* Steps:
* - run the migration by Ids
* - assert 0 CDLs were created
*/
        Contact c = NMTTestNoteUtils.createContact();
        List<String> resultAux = new List<String>();
        //get the ids
        resultAux.add('aa');
        
        Test.startTest();
        //run the migration by Ids  
        NMTMigratorBatch batch = new NMTMigratorBatch(null, resultAux, 'byId', null, System.today(), System.today(), true);
        Id batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
        Test.stopTest();
        
        List<ContentDocumentLink> cdls = [SELECT Id FROM ContentDocumentLink WHERE
                                          linkedEntityId = :c.Id
                                          AND
                                          contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c in :resultAux];
        //assert no CDLs were created
        System.assert(cdls.isEmpty());
        }
    }
    
    /**
* @description tests notes migration by Object Names with negative quantity
* Test Case Name: Test limit values (max, min) at quantity input
*/
    @isTest
    static void testNotestMigrationByObjectNameNegative(){
        if(NAMUtils.isEnhancedNotesEnabled()||NAMUtils.ENABLE_NOTES_TESTS){
        /*
* Steps:
* - create a Contact
* - create 100 legacy note per Contact
* - run the migration by Objects Names and -10 as quantity
* - assert no contentVersions were created
* - assert NotesPendingToConvert = 100
*/
        
        Contact c = NMTTestNoteUtils.createContact();
        //create two legacy notes for the Contact
        NMTTestNoteUtils.createNoteForObject(100, c.Id, false);
        
        Test.startTest();
        //run the migration by Objects Type 
        NMTMigratorBatch batch = new NMTMigratorBatch('Contact', null, 'byObject',-10, System.today(), System.today(), true);
        Id batchId = Database.executeBatch(batch, 100);
        NMTNoteConversionStatus.changeStatus('Progress', batchId,'Convertion');
        Test.stopTest();
        
        List<NAMNoteConverted__C> contentVersions = [SELECT Id FROM NAMNoteConverted__C];
        //assert no contentVersion were created
        System.assert(contentVersions.isEmpty());
        
        List<ContentDocumentLink> cdlsContact = [SELECT Id FROM ContentDocumentLink WHERE
                                                 linkedEntityId = :c.Id
                                                 AND
                                                 contentDocument.latestPublishedVersion.LegacyNoteConvertedId__c != null];
        
        //assert no CDLs were created 
        System.assert(cdlsContact.isEmpty());
        
        NAMNoteConversionStatus__c conversionStatus = NMTNoteConversionStatus.find().get(0);
        }
    }
}